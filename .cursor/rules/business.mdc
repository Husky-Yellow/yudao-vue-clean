---
description: ç‰©è”ç½‘æ²»ç† - ä¼ä¸šçº§ä¸šåŠ¡å¼€å‘å®æˆ˜æŒ‡å—
glob: "**/*.{vue,ts,js}"
alwaysApply: true
---

# ğŸ­ ç‰©è”ç½‘æ²»ç† - ä¼ä¸šçº§ä¸šåŠ¡å¼€å‘å®æˆ˜æŒ‡å—

ä½ æ˜¯ä¸€ä½ **ç‰©è”ç½‘ä¸šåŠ¡ç³»ç»Ÿæ¶æ„å¸ˆ**ï¼Œç²¾é€šè®¾å¤‡ç®¡ç†ã€å·¥ä½œæµå¼•æ“ã€RBAC æƒé™ç³»ç»Ÿï¼Œæ·±åº¦ç†è§£ä¼ä¸šçº§ç‰©è”ç½‘æ²»ç†å¹³å°çš„ä¸šåŠ¡ç‰¹ç‚¹ã€æŠ€æœ¯æ¶æ„å’Œå¼€å‘æ¨¡å¼ã€‚

## ğŸ¯ ä¸šåŠ¡åŸŸæ·±åº¦è§£æ

### ğŸ”Œ è®¾å¤‡ç®¡ç†ä¸šåŠ¡åŸŸ (EquipmentManagement)

#### ğŸ“Š ä¸šåŠ¡åœºæ™¯çŸ©é˜µ
```
è®¾å¤‡ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼š
â”œâ”€â”€ ğŸ†• è®¾å¤‡æ³¨å†Œå…¥ç½‘
â”‚   â”œâ”€â”€ è®¾å¤‡ä¿¡æ¯å½•å…¥ â†’ ç½‘ç»œé…ç½® â†’ ä½ç½®éƒ¨ç½² â†’ åŠŸèƒ½æµ‹è¯•
â”‚   â””â”€â”€ æ‰¹é‡å¯¼å…¥ â†’ æ¨¡æ¿éªŒè¯ â†’ è‡ªåŠ¨é…ç½® â†’ çŠ¶æ€åŒæ­¥
â”œâ”€â”€ ğŸ”„ è®¾å¤‡è¿è¡Œç»´æŠ¤  
â”‚   â”œâ”€â”€ å®æ—¶ç›‘æ§ â†’ çŠ¶æ€å‘Šè­¦ â†’ æ•…éšœè¯Šæ–­ â†’ è¿œç¨‹æ§åˆ¶
â”‚   â””â”€â”€ æ•°æ®é‡‡é›† â†’ æ€§èƒ½åˆ†æ â†’ é¢„æµ‹ç»´æŠ¤ â†’ é…ç½®ä¼˜åŒ–
â”œâ”€â”€ ğŸ”§ è®¾å¤‡å‡çº§ç®¡ç†
â”‚   â”œâ”€â”€ å›ºä»¶ç®¡ç† â†’ ç‰ˆæœ¬æ§åˆ¶ â†’ å‡çº§è°ƒåº¦ â†’ å›æ»šæœºåˆ¶
â”‚   â””â”€â”€ æ‰¹é‡å‡çº§ â†’ ç°åº¦å‘å¸ƒ â†’ çŠ¶æ€ç›‘æ§ â†’ å¼‚å¸¸å¤„ç†
â””â”€â”€ ğŸ—‘ï¸ è®¾å¤‡ç”Ÿå‘½ç»ˆç»“
    â”œâ”€â”€ åœç”¨æµç¨‹ â†’ æ•°æ®å¤‡ä»½ â†’ èµ„äº§å¤„ç½® â†’ è®°å½•å½’æ¡£
    â””â”€â”€ æ‰¹é‡é€€å½¹ â†’ æ¸…ç†é…ç½® â†’ æ›´æ–°å°è´¦ â†’ åˆè§„å®¡è®¡
```

#### ğŸ¨ è®¾å¤‡ç®¡ç†æ ¸å¿ƒç»„ä»¶è®¾è®¡
```vue
<!-- è®¾å¤‡ç®¡ç†ä¸»æ§å° -->
<template>
  <div class="device-management-dashboard">
    <!-- ğŸ”¥ è®¾å¤‡çŠ¶æ€å®æ—¶ç›‘æ§å¤§å± -->
    <DeviceStatusOverview
      :statistics="deviceStatistics"
      :real-time-data="realtimeDeviceData"
      @filter-by-status="handleStatusFilter"
      @drill-down="handleDrillDown"
    />

    <!-- ğŸ“Š è®¾å¤‡åˆ†å¸ƒåœ°å›¾å¯è§†åŒ– -->
    <DeviceMapVisualization
      :devices="geoLocatedDevices"
      :map-config="mapConfiguration"
      :clustering-enabled="true"
      @device-select="handleDeviceMapSelect"
      @area-select="handleAreaAnalysis"
    />

    <!-- ğŸ›ï¸ è®¾å¤‡æ§åˆ¶ä¸­å¿ƒ -->
    <DeviceControlCenter
      v-if="selectedDevice"
      :device="selectedDevice"
      :control-permissions="deviceControlPermissions"
      @control-command="handleDeviceControl"
      @parameter-update="handleParameterUpdate"
    />

    <!-- ğŸ“‹ è®¾å¤‡ç®¡ç†æ•°æ®è¡¨æ ¼ -->
    <SmartDeviceTable
      :devices="filteredDevices"
      :columns="deviceTableColumns"
      :loading="tableLoading"
      :pagination="paginationConfig"
      :bulk-actions="deviceBulkActions"
      @row-action="handleDeviceAction"
      @bulk-action="handleBulkAction"
      @export="handleDeviceExport"
    />

    <!-- ğŸ”§ è®¾å¤‡é…ç½®å‘å¯¼ -->
    <DeviceConfigurationWizard
      v-model="configWizardVisible"
      :device-type="selectedDeviceType"
      :configuration-templates="configTemplates"
      @configuration-complete="handleConfigurationComplete"
    />

    <!-- ğŸ“ˆ è®¾å¤‡æ€§èƒ½åˆ†æå¯¹è¯æ¡† -->
    <DeviceAnalyticsDialog
      v-model="analyticsDialogVisible"
      :device="analyticsDevice"
      :metrics="deviceMetrics"
      :time-range="analyticsTimeRange"
    />
  </div>
</template>

<script setup lang="ts">
// ğŸ¯ è®¾å¤‡ç®¡ç†ä¸šåŠ¡é€»è¾‘ Hook
import { useDeviceManagement } from '@/hooks/business/useDeviceManagement'
import { useDeviceRealtime } from '@/hooks/business/useDeviceRealtime'
import { useDeviceAnalytics } from '@/hooks/business/useDeviceAnalytics'
import { useGeoVisualization } from '@/hooks/common/useGeoVisualization'

// ğŸ“Š ç±»å‹å®šä¹‰
import type { 
  DeviceEntity,
  DeviceControlCommand,
  DeviceAnalyticsData,
  GeoDevice,
  DeviceConfigurationTemplate
} from '@/api/EquipmentManagement/types'

defineOptions({
  name: 'DeviceManagementDashboard'
})

// ğŸ”„ å®æ—¶è®¾å¤‡æ•°æ®ç®¡ç†
const {
  // è®¾å¤‡æ•°æ®çŠ¶æ€
  allDevices,
  filteredDevices,
  selectedDevice,
  deviceStatistics,
  
  // è¡¨æ ¼é…ç½®
  deviceTableColumns,
  tableLoading,
  paginationConfig,
  
  // ä¸šåŠ¡æ“ä½œ
  methods: {
    handleDeviceAction,
    handleBulkAction,
    handleDeviceExport,
    refreshDeviceData
  }
} = useDeviceManagement()

// âš¡ å®æ—¶æ•°æ®åŒæ­¥
const {
  realtimeDeviceData,
  connectionStatus,
  startRealTimeSync,
  stopRealTimeSync
} = useDeviceRealtime({
  devices: allDevices,
  updateInterval: 5000,
  autoReconnect: true
})

// ğŸ—ºï¸ åœ°å›¾å¯è§†åŒ–
const {
  geoLocatedDevices,
  mapConfiguration,
  selectedMapDevice,
  handleDeviceMapSelect,
  handleAreaAnalysis
} = useGeoVisualization({
  devices: allDevices,
  mapProvider: 'mapmost',
  clusteringThreshold: 10
})

// ğŸ“ˆ è®¾å¤‡æ€§èƒ½åˆ†æ
const {
  deviceMetrics,
  analyticsTimeRange,
  generateAnalyticsReport,
  exportAnalyticsData
} = useDeviceAnalytics()

// ğŸ›ï¸ è®¾å¤‡æ§åˆ¶é€»è¾‘
const handleDeviceControl = async (command: DeviceControlCommand) => {
  try {
    await deviceControlApi.executeCommand(selectedDevice.value.id, command)
    ElMessage.success('è®¾å¤‡æ§åˆ¶æŒ‡ä»¤æ‰§è¡ŒæˆåŠŸ')
    await refreshDeviceData()
  } catch (error) {
    ElMessage.error('è®¾å¤‡æ§åˆ¶å¤±è´¥ï¼Œè¯·æ£€æŸ¥è®¾å¤‡çŠ¶æ€')
  }
}

// ğŸ”„ ç”Ÿå‘½å‘¨æœŸç®¡ç†
onMounted(() => {
  refreshDeviceData()
  startRealTimeSync()
})

onUnmounted(() => {
  stopRealTimeSync()
})
</script>
```

### ğŸ“‹ å·¥ä½œæµå¼•æ“ä¸šåŠ¡åŸŸ (WorkflowEngine)

#### ğŸ”„ å·¥ä½œæµä¸šåŠ¡åœºæ™¯æ¶æ„
```
ä¼ä¸šæµç¨‹æ•°å­—åŒ–ï¼š
â”œâ”€â”€ ğŸ“ è®¾å¤‡ç»´æŠ¤æµç¨‹
â”‚   â”œâ”€â”€ ç»´æŠ¤ç”³è¯· â†’ å®¡æ‰¹ç¡®è®¤ â†’ è®¡åˆ’å®‰æ’ â†’ æ‰§è¡Œç»´æŠ¤ â†’ éªŒæ”¶å®Œæˆ
â”‚   â””â”€â”€ ç´§æ€¥ç»´æŠ¤ â†’ å¿«é€Ÿå®¡æ‰¹ â†’ å³æ—¶å“åº” â†’ çŠ¶æ€è·Ÿè¸ª â†’ æ€»ç»“å½’æ¡£
â”œâ”€â”€ ğŸ”§ è®¾å¤‡æ•…éšœå¤„ç†æµç¨‹
â”‚   â”œâ”€â”€ æ•…éšœä¸ŠæŠ¥ â†’ åˆæ­¥è¯Šæ–­ â†’ é—®é¢˜åˆ†æ â†’ è§£å†³æ–¹æ¡ˆ â†’ ä¿®å¤éªŒè¯
â”‚   â””â”€â”€ å‡çº§å¤„ç† â†’ ä¸“å®¶ä»‹å…¥ â†’ æ–¹æ¡ˆè¯„å®¡ â†’ å®æ–½ä¿®å¤ â†’ æ•ˆæœè¯„ä¼°
â”œâ”€â”€ ğŸ“Š è®¾å¤‡å˜æ›´ç®¡ç†æµç¨‹
â”‚   â”œâ”€â”€ å˜æ›´ç”³è¯· â†’ å½±å“è¯„ä¼° â†’ é£é™©åˆ†æ â†’ æ–¹æ¡ˆå®¡æ‰¹ â†’ å®æ–½å˜æ›´
â”‚   â””â”€â”€ æµ‹è¯•éªŒè¯ â†’ ä¸Šçº¿éƒ¨ç½² â†’ ç›‘æ§è§‚å¯Ÿ â†’ æ•ˆæœè¯„ä¼° â†’ æµç¨‹ä¼˜åŒ–
â””â”€â”€ ğŸ” æƒé™ç”³è¯·æµç¨‹
    â”œâ”€â”€ æƒé™ç”³è¯· â†’ éƒ¨é—¨å®¡æ‰¹ â†’ å®‰å…¨è¯„ä¼° â†’ ç®¡ç†å®¡æ‰¹ â†’ æƒé™æˆäºˆ
    â””â”€â”€ ä¸´æ—¶æƒé™ â†’ å¿«é€Ÿå®¡æ‰¹ â†’ æ—¶é™æ§åˆ¶ â†’ åˆ°æœŸå›æ”¶ â†’ ä½¿ç”¨å®¡è®¡
```

#### ğŸ­ å·¥ä½œæµæ ¸å¿ƒç»„ä»¶å®ç°
```vue
<!-- ä¼ä¸šçº§æµç¨‹ç®¡ç†ä¸­å¿ƒ -->
<template>
  <div class="workflow-management-center">
    <!-- ğŸ¯ æµç¨‹æ¦‚è§ˆä»ªè¡¨æ¿ -->
    <ProcessOverviewDashboard
      :active-processes="activeProcesses"
      :process-statistics="processStatistics"
      :sla-monitoring="slaMonitoring"
      @process-drill-down="handleProcessDrillDown"
    />

    <!-- ğŸ¨ å¯è§†åŒ–æµç¨‹è®¾è®¡å™¨ -->
    <ProcessDesignerPanel
      v-if="designerMode"
      :process-definition="currentProcessDefinition"
      :component-palette="bpmnComponentPalette"
      :validation-rules="processValidationRules"
      @save-process="handleProcessSave"
      @deploy-process="handleProcessDeploy"
    />

    <!-- ğŸ“‹ æ™ºèƒ½ä»»åŠ¡å¤„ç†ä¸­å¿ƒ -->
    <TaskProcessingCenter
      :pending-tasks="pendingTasks"
      :task-filters="taskFilterOptions"
      :user-preferences="userTaskPreferences"
      @task-complete="handleTaskComplete"
      @task-delegate="handleTaskDelegate"
      @batch-process="handleBatchTaskProcess"
    />

    <!-- ğŸ“Š æµç¨‹ç›‘æ§åˆ†æ -->
    <ProcessAnalyticsDashboard
      :process-instances="processInstances"
      :performance-metrics="processMetrics"
      :bottleneck-analysis="bottleneckData"
      @optimization-suggestion="handleOptimizationSuggestion"
    />

    <!-- ğŸ” æµç¨‹å®ä¾‹è¯¦æƒ…æŸ¥çœ‹å™¨ -->
    <ProcessInstanceViewer
      v-model="instanceViewerVisible"
      :process-instance="selectedProcessInstance"
      :execution-history="instanceExecutionHistory"
      :related-documents="instanceDocuments"
    />
  </div>
</template>

<script setup lang="ts">
import { useWorkflowEngine } from '@/hooks/business/useWorkflowEngine'
import { useProcessDesigner } from '@/hooks/business/useProcessDesigner'
import { useTaskManagement } from '@/hooks/business/useTaskManagement'
import { useProcessAnalytics } from '@/hooks/business/useProcessAnalytics'

import type {
  ProcessDefinition,
  ProcessInstance,
  TaskInfo,
  ProcessMetrics,
  BpmnComponentPalette
} from '@/api/WorkflowEngine/types'

defineOptions({
  name: 'WorkflowManagementCenter'
})

// ğŸ”„ å·¥ä½œæµå¼•æ“ç®¡ç†
const {
  activeProcesses,
  processStatistics,
  currentProcessDefinition,
  selectedProcessInstance,
  methods: {
    startProcess,
    suspendProcess,
    resumeProcess,
    terminateProcess,
    getProcessHistory
  }
} = useWorkflowEngine()

// ğŸ¨ æµç¨‹è®¾è®¡å™¨
const {
  designerMode,
  bpmnComponentPalette,
  processValidationRules,
  handleProcessSave,
  handleProcessDeploy,
  validateProcessDefinition
} = useProcessDesigner()

// ğŸ“‹ ä»»åŠ¡ç®¡ç†
const {
  pendingTasks,
  taskFilterOptions,
  userTaskPreferences,
  handleTaskComplete,
  handleTaskDelegate,
  handleBatchTaskProcess
} = useTaskManagement()

// ğŸ“Š æµç¨‹åˆ†æ
const {
  processMetrics,
  bottleneckData,
  slaMonitoring,
  generatePerformanceReport,
  identifyOptimizationOpportunities
} = useProcessAnalytics()

// ğŸ¯ ä¸šåŠ¡äº¤äº’å¤„ç†
const handleProcessDrillDown = (processKey: string) => {
  router.push(`/workflow/process/${processKey}/instances`)
}

const handleOptimizationSuggestion = (suggestion: OptimizationSuggestion) => {
  // å®ç°æµç¨‹ä¼˜åŒ–å»ºè®®å¤„ç†é€»è¾‘
  ElMessageBox.confirm(
    suggestion.description,
    'æµç¨‹ä¼˜åŒ–å»ºè®®',
    {
      confirmButtonText: 'é‡‡çº³å»ºè®®',
      cancelButtonText: 'æš‚ä¸å¤„ç†',
      type: 'info'
    }
  ).then(() => {
    applyOptimizationSuggestion(suggestion)
  })
}
</script>
```

### ğŸ” æƒé™ç®¡ç†ä¸šåŠ¡åŸŸ (AuthorizationManagement)

#### ğŸ›¡ï¸ RBAC æƒé™æ¶æ„è®¾è®¡
```
ä¼ä¸šçº§æƒé™æ²»ç†ï¼š
â”œâ”€â”€ ğŸ‘¥ ç”¨æˆ·èº«ä»½ç®¡ç†
â”‚   â”œâ”€â”€ ç”¨æˆ·æ³¨å†Œ â†’ èº«ä»½éªŒè¯ â†’ è§’è‰²åˆ†é… â†’ æƒé™æ¿€æ´»
â”‚   â””â”€â”€ æ‰¹é‡å¯¼å…¥ â†’ ä¿¡æ¯æ ¡éªŒ â†’ è§’è‰²æ˜ å°„ â†’ æƒé™åŒæ­¥
â”œâ”€â”€ ğŸ­ è§’è‰²æƒé™ç®¡ç†
â”‚   â”œâ”€â”€ è§’è‰²å®šä¹‰ â†’ æƒé™åˆ†é… â†’ ç”¨æˆ·å…³è” â†’ æƒé™ç”Ÿæ•ˆ
â”‚   â””â”€â”€ è§’è‰²ç»§æ‰¿ â†’ æƒé™ç»„åˆ â†’ å†²çªè§£å†³ â†’ æƒé™ä¼˜åŒ–
â”œâ”€â”€ ğŸ”‘ èµ„æºæƒé™æ§åˆ¶
â”‚   â”œâ”€â”€ èµ„æºå®šä¹‰ â†’ æƒé™ç­–ç•¥ â†’ è®¿é—®æ§åˆ¶ â†’ å®¡è®¡æ—¥å¿—
â”‚   â””â”€â”€ åŠ¨æ€æƒé™ â†’ æ¡ä»¶æ§åˆ¶ â†’ æ—¶é—´é™åˆ¶ â†’ åœ°åŸŸé™åˆ¶
â””â”€â”€ ğŸ“Š æƒé™æ•°æ®æ²»ç†
    â”œâ”€â”€ æƒé™å®¡è®¡ â†’ åˆè§„æ£€æŸ¥ â†’ é£é™©è¯„ä¼° â†’ ä¼˜åŒ–å»ºè®®
    â””â”€â”€ æƒé™åˆ†æ â†’ ä½¿ç”¨ç»Ÿè®¡ â†’ å¼‚å¸¸æ£€æµ‹ â†’ å®‰å…¨åŠ å›º
```

#### ğŸ” æƒé™ç®¡ç†æ ¸å¿ƒå®ç°
```vue
<!-- ä¼ä¸šçº§æƒé™ç®¡ç†ä¸­å¿ƒ -->
<template>
  <div class="permission-management-center">
    <!-- ğŸ¯ æƒé™æ¦‚è§ˆä»ªè¡¨æ¿ -->
    <PermissionOverviewDashboard
      :user-statistics="userStatistics"
      :role-distribution="roleDistribution"
      :permission-usage="permissionUsage"
      :security-alerts="securityAlerts"
    />

    <!-- ğŸ‘¥ ç”¨æˆ·æƒé™ç®¡ç† -->
    <UserPermissionManagement
      :users="userList"
      :roles="availableRoles"
      :permissions="availablePermissions"
      @user-role-change="handleUserRoleChange"
      @permission-grant="handlePermissionGrant"
      @permission-revoke="handlePermissionRevoke"
    />

    <!-- ğŸ­ è§’è‰²æƒé™é…ç½® -->
    <RolePermissionConfiguration
      :roles="roleList"
      :permission-tree="permissionTree"
      :inheritance-map="roleInheritanceMap"
      @role-create="handleRoleCreate"
      @role-update="handleRoleUpdate"
      @role-delete="handleRoleDelete"
    />

    <!-- ğŸ” æƒé™å®¡è®¡ä¸­å¿ƒ -->
    <PermissionAuditCenter
      :audit-logs="permissionAuditLogs"
      :compliance-reports="complianceReports"
      :risk-assessments="riskAssessments"
      @generate-audit-report="handleGenerateAuditReport"
      @export-compliance-data="handleExportComplianceData"
    />

    <!-- âš™ï¸ æƒé™ç­–ç•¥é…ç½® -->
    <PermissionPolicyConfiguration
      :policies="permissionPolicies"
      :policy-templates="policyTemplates"
      :condition-rules="conditionRules"
      @policy-create="handlePolicyCreate"
      @policy-test="handlePolicyTest"
    />
  </div>
</template>

<script setup lang="ts">
import { usePermissionManagement } from '@/hooks/business/usePermissionManagement'
import { useRoleManagement } from '@/hooks/business/useRoleManagement'
import { usePermissionAudit } from '@/hooks/business/usePermissionAudit'
import { usePermissionPolicy } from '@/hooks/business/usePermissionPolicy'

import type {
  UserEntity,
  RoleEntity,
  PermissionEntity,
  PermissionPolicy,
  AuditLog,
  ComplianceReport
} from '@/api/AuthorizationManagement/types'

defineOptions({
  name: 'PermissionManagementCenter'
})

// ğŸ” æƒé™ç®¡ç†æ ¸å¿ƒ
const {
  userList,
  userStatistics,
  availableRoles,
  availablePermissions,
  methods: {
    handleUserRoleChange,
    handlePermissionGrant,
    handlePermissionRevoke,
    validateUserPermissions
  }
} = usePermissionManagement()

// ğŸ­ è§’è‰²ç®¡ç†
const {
  roleList,
  roleDistribution,
  roleInheritanceMap,
  permissionTree,
  methods: {
    handleRoleCreate,
    handleRoleUpdate,
    handleRoleDelete,
    calculateEffectivePermissions
  }
} = useRoleManagement()

// ğŸ“Š æƒé™å®¡è®¡
const {
  permissionAuditLogs,
  complianceReports,
  riskAssessments,
  permissionUsage,
  securityAlerts,
  handleGenerateAuditReport,
  handleExportComplianceData
} = usePermissionAudit()

// âš™ï¸ æƒé™ç­–ç•¥
const {
  permissionPolicies,
  policyTemplates,
  conditionRules,
  handlePolicyCreate,
  handlePolicyTest,
  evaluatePolicyCompliance
} = usePermissionPolicy()
</script>
```

## ğŸ¨ ä¸šåŠ¡ Composables è®¾è®¡æ¨¡å¼

### ğŸ”§ è®¾å¤‡ç®¡ç†ä¸šåŠ¡ Hook
```typescript
// hooks/business/useDeviceManagement.ts
export function useDeviceManagement() {
  // ğŸ—‚ï¸ è®¾å¤‡æ•°æ®çŠ¶æ€
  const allDevices = ref<DeviceEntity[]>([])
  const filteredDevices = ref<DeviceEntity[]>([])
  const selectedDevice = ref<DeviceEntity | null>(null)
  const deviceStatistics = ref<DeviceStatistics>({
    total: 0,
    online: 0,
    offline: 0,
    error: 0,
    maintenance: 0
  })

  // ğŸ“Š è¡¨æ ¼é…ç½®
  const tableLoading = ref(false)
  const paginationConfig = reactive<PaginationConfig>({
    current: 1,
    pageSize: 20,
    total: 0,
    showSizeChanger: true,
    showQuickJumper: true,
    pageSizeOptions: ['10', '20', '50', '100']
  })

  // ğŸ›ï¸ è®¾å¤‡æ§åˆ¶æƒé™
  const deviceControlPermissions = computed(() => {
    return selectedDevice.value 
      ? calculateDeviceControlPermissions(selectedDevice.value)
      : []
  })

  // ğŸ“‹ è¡¨æ ¼åˆ—é…ç½®
  const deviceTableColumns = computed<TableColumn[]>(() => [
    {
      key: 'deviceName',
      title: 'è®¾å¤‡åç§°',
      width: 200,
      sortable: true,
      filterable: true
    },
    {
      key: 'deviceType',
      title: 'è®¾å¤‡ç±»å‹',
      width: 120,
      render: (record) => (
        <DeviceTypeBadge type={record.deviceType} />
      )
    },
    {
      key: 'deviceStatus',
      title: 'è®¾å¤‡çŠ¶æ€',
      width: 120,
      render: (record) => (
        <DeviceStatusBadge 
          status={record.deviceStatus}
          lastOnline={record.lastOnlineTime}
        />
      )
    },
    {
      key: 'location',
      title: 'å®‰è£…ä½ç½®',
      width: 200,
      render: (record) => (
        <LocationDisplay
          latitude={record.installLocation.latitude}
          longitude={record.installLocation.longitude}
          address={record.installLocation.address}
        />
      )
    },
    {
      key: 'actions',
      title: 'æ“ä½œ',
      width: 200,
      fixed: 'right',
      render: (record) => (
        <ActionDropdown
          actions={getDeviceActions(record)}
          onAction={(action) => handleDeviceAction(action, record)}
        />
      )
    }
  ])

  // ğŸ”„ è®¾å¤‡æ•°æ®åˆ·æ–°
  const refreshDeviceData = async () => {
    try {
      tableLoading.value = true
      const response = await deviceApi.getDeviceList({
        pageNum: paginationConfig.current,
        pageSize: paginationConfig.pageSize
      })
      
      allDevices.value = response.data.list
      filteredDevices.value = response.data.list
      paginationConfig.total = response.data.total
      
      // æ›´æ–°è®¾å¤‡ç»Ÿè®¡ä¿¡æ¯
      updateDeviceStatistics()
    } catch (error) {
      ElMessage.error('è®¾å¤‡æ•°æ®åŠ è½½å¤±è´¥')
    } finally {
      tableLoading.value = false
    }
  }

  // ğŸ“Š è®¾å¤‡ç»Ÿè®¡æ›´æ–°
  const updateDeviceStatistics = () => {
    const stats = allDevices.value.reduce((acc, device) => {
      acc.total++
      acc[device.deviceStatus]++
      return acc
    }, {
      total: 0,
      online: 0,
      offline: 0,
      error: 0,
      maintenance: 0
    })
    
    deviceStatistics.value = stats
  }

  // ğŸ¯ è®¾å¤‡æ“ä½œå¤„ç†
  const handleDeviceAction = async (action: string, device: DeviceEntity) => {
    switch (action) {
      case 'view':
        selectedDevice.value = device
        break
      case 'edit':
        router.push(`/equipment/device/${device.id}/edit`)
        break
      case 'control':
        await openDeviceControlPanel(device)
        break
      case 'maintenance':
        await scheduleDeviceMaintenance(device)
        break
      case 'delete':
        await confirmDeviceDeletion(device)
        break
    }
  }

  // ğŸ“¤ è®¾å¤‡æ•°æ®å¯¼å‡º
  const handleDeviceExport = async (exportParams: DeviceExportParams) => {
    try {
      const blob = await deviceApi.exportDeviceData(exportParams)
      downloadFile(blob, `è®¾å¤‡æ•°æ®_${dayjs().format('YYYY-MM-DD')}.xlsx`)
      ElMessage.success('è®¾å¤‡æ•°æ®å¯¼å‡ºæˆåŠŸ')
    } catch (error) {
      ElMessage.error('è®¾å¤‡æ•°æ®å¯¼å‡ºå¤±è´¥')
    }
  }

  // ğŸ›ï¸ æ‰¹é‡æ“ä½œå¤„ç†
  const handleBulkAction = async (action: string, devices: DeviceEntity[]) => {
    const deviceIds = devices.map(d => d.id)
    
    switch (action) {
      case 'bulk_control':
        await executeBulkDeviceControl(deviceIds)
        break
      case 'bulk_maintenance':
        await scheduleBulkMaintenance(deviceIds)
        break
      case 'bulk_delete':
        await confirmBulkDeletion(deviceIds)
        break
    }
  }

  return {
    // æ•°æ®çŠ¶æ€
    allDevices: readonly(allDevices),
    filteredDevices: readonly(filteredDevices),
    selectedDevice: readonly(selectedDevice),
    deviceStatistics: readonly(deviceStatistics),
    
    // UI é…ç½®
    deviceTableColumns,
    tableLoading: readonly(tableLoading),
    paginationConfig,
    deviceControlPermissions,
    
    // ä¸šåŠ¡æ–¹æ³•
    methods: {
      refreshDeviceData,
      handleDeviceAction,
      handleDeviceExport,
      handleBulkAction,
      updateDeviceStatistics
    }
  }
}
```

### ğŸ”„ å·¥ä½œæµä¸šåŠ¡ Hook
```typescript
// hooks/business/useWorkflowEngine.ts
export function useWorkflowEngine() {
  // ğŸ“‹ æµç¨‹çŠ¶æ€ç®¡ç†
  const activeProcesses = ref<ProcessInstance[]>([])
  const processStatistics = ref<ProcessStatistics>({
    totalInstances: 0,
    runningInstances: 0,
    completedInstances: 0,
    suspendedInstances: 0,
    averageCompletionTime: 0
  })

  // ğŸ¯ å½“å‰æµç¨‹ä¸Šä¸‹æ–‡
  const currentProcessDefinition = ref<ProcessDefinition | null>(null)
  const selectedProcessInstance = ref<ProcessInstance | null>(null)

  // ğŸ”„ æµç¨‹æ“ä½œæ–¹æ³•
  const startProcess = async (
    definitionId: string, 
    businessKey: string,
    variables: Record<string, any>
  ): Promise<ProcessInstance> => {
    try {
      const response = await processApi.startProcess({
        processDefinitionId: definitionId,
        businessKey,
        variables
      })
      
      // æ›´æ–°æ´»è·ƒæµç¨‹åˆ—è¡¨
      await refreshActiveProcesses()
      
      ElMessage.success('æµç¨‹å¯åŠ¨æˆåŠŸ')
      return response.data
    } catch (error) {
      ElMessage.error('æµç¨‹å¯åŠ¨å¤±è´¥')
      throw error
    }
  }

  // â¸ï¸ æµç¨‹æš‚åœ
  const suspendProcess = async (instanceId: string): Promise<void> => {
    try {
      await processApi.suspendProcess(instanceId)
      await refreshActiveProcesses()
      ElMessage.success('æµç¨‹å·²æš‚åœ')
    } catch (error) {
      ElMessage.error('æµç¨‹æš‚åœå¤±è´¥')
      throw error
    }
  }

  // â–¶ï¸ æµç¨‹æ¢å¤
  const resumeProcess = async (instanceId: string): Promise<void> => {
    try {
      await processApi.resumeProcess(instanceId)
      await refreshActiveProcesses()
      ElMessage.success('æµç¨‹å·²æ¢å¤')
    } catch (error) {
      ElMessage.error('æµç¨‹æ¢å¤å¤±è´¥')
      throw error
    }
  }

  // ğŸ›‘ æµç¨‹ç»ˆæ­¢
  const terminateProcess = async (
    instanceId: string, 
    reason: string
  ): Promise<void> => {
    try {
      await processApi.terminateProcess(instanceId, reason)
      await refreshActiveProcesses()
      ElMessage.success('æµç¨‹å·²ç»ˆæ­¢')
    } catch (error) {
      ElMessage.error('æµç¨‹ç»ˆæ­¢å¤±è´¥')
      throw error
    }
  }

  // ğŸ“š æµç¨‹å†å²æŸ¥è¯¢
  const getProcessHistory = async (
    instanceId: string
  ): Promise<ProcessHistoryEvent[]> => {
    try {
      const response = await processApi.getProcessHistory(instanceId)
      return response.data
    } catch (error) {
      ElMessage.error('æµç¨‹å†å²æŸ¥è¯¢å¤±è´¥')
      return []
    }
  }

  // ğŸ”„ åˆ·æ–°æ´»è·ƒæµç¨‹
  const refreshActiveProcesses = async () => {
    try {
      const response = await processApi.getActiveProcesses()
      activeProcesses.value = response.data.list
      
      // æ›´æ–°æµç¨‹ç»Ÿè®¡ä¿¡æ¯
      updateProcessStatistics()
    } catch (error) {
      ElMessage.error('æµç¨‹æ•°æ®åŠ è½½å¤±è´¥')
    }
  }

  // ğŸ“Š æ›´æ–°æµç¨‹ç»Ÿè®¡
  const updateProcessStatistics = () => {
    const stats = activeProcesses.value.reduce((acc, process) => {
      acc.totalInstances++
      
      switch (process.status) {
        case 'running':
          acc.runningInstances++
          break
        case 'completed':
          acc.completedInstances++
          break
        case 'suspended':
          acc.suspendedInstances++
          break
      }
      
      if (process.duration) {
        acc.totalDuration += process.duration
      }
      
      return acc
    }, {
      totalInstances: 0,
      runningInstances: 0,
      completedInstances: 0,
      suspendedInstances: 0,
      totalDuration: 0
    })
    
    stats.averageCompletionTime = stats.completedInstances > 0 
      ? stats.totalDuration / stats.completedInstances 
      : 0
    
    processStatistics.value = stats
  }

  return {
    // æµç¨‹çŠ¶æ€
    activeProcesses: readonly(activeProcesses),
    processStatistics: readonly(processStatistics),
    currentProcessDefinition: readonly(currentProcessDefinition),
    selectedProcessInstance: readonly(selectedProcessInstance),
    
    // æµç¨‹æ“ä½œæ–¹æ³•
    methods: {
      startProcess,
      suspendProcess,
      resumeProcess,
      terminateProcess,
      getProcessHistory,
      refreshActiveProcesses,
      updateProcessStatistics
    }
  }
}
```

## ğŸ¯ ä¼ä¸šçº§å¼€å‘æœ€ä½³å®è·µ

### 1. ğŸš€ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥
- **æ•°æ®è™šæ‹ŸåŒ–** - å¤§é‡è®¾å¤‡æ•°æ®ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨å’Œåˆ†é¡µåŠ è½½  
- **å®æ—¶æ•°æ®ä¼˜åŒ–** - WebSocket è¿æ¥æ±  + æ•°æ®å»é‡ + å¢é‡æ›´æ–°
- **åœ°å›¾æ€§èƒ½** - è®¾å¤‡èšåˆæ˜¾ç¤º + LOD å±‚çº§ç»†èŠ‚ + ç“¦ç‰‡ç¼“å­˜
- **ç»„ä»¶æ‡’åŠ è½½** - è·¯ç”±çº§åˆ«å’Œç»„ä»¶çº§åˆ«çš„æŒ‰éœ€åŠ è½½

### 2. ğŸ”’ ä¸šåŠ¡å®‰å…¨ä¿éšœ
- **æƒé™ç»†ç²’åº¦æ§åˆ¶** - é¡µé¢ã€æŒ‰é’®ã€APIã€æ•°æ®å››ä¸ªå±‚çº§
- **æ“ä½œå®¡è®¡è¿½è¸ª** - å…³é”®ä¸šåŠ¡æ“ä½œå…¨ç¨‹è®°å½•å’Œè¿½æº¯
- **æ•°æ®å®‰å…¨é˜²æŠ¤** - æ•æ„Ÿæ•°æ®åŠ å¯† + è®¿é—®æ—¥å¿— + æƒé™æ ¡éªŒ
- **ä¸šåŠ¡è§„åˆ™æ ¡éªŒ** - å‰åç«¯åŒé‡æ ¡éªŒ + ä¸šåŠ¡é€»è¾‘ä¸€è‡´æ€§

### 3. ğŸ—ï¸ æ¶æ„å¯æ‰©å±•æ€§
- **å¾®å‰ç«¯æ¶æ„** - ä¸šåŠ¡åŸŸç‹¬ç«‹å¼€å‘ + è¿è¡Œæ—¶é›†æˆ
- **æ’ä»¶åŒ–è®¾è®¡** - è®¾å¤‡ç±»å‹æ’ä»¶ + æµç¨‹èŠ‚ç‚¹æ’ä»¶ + æƒé™ç­–ç•¥æ’ä»¶
- **é…ç½®é©±åŠ¨** - è¡¨å•é…ç½®åŒ– + æµç¨‹é…ç½®åŒ– + æƒé™é…ç½®åŒ–
- **å¤šç§Ÿæˆ·æ”¯æŒ** - æ•°æ®éš”ç¦» + æƒé™éš”ç¦» + é…ç½®éš”ç¦»

### 4. ğŸ”§ å¼€å‘æ•ˆç‡æå‡
- **ä»£ç ç”Ÿæˆå·¥å…·** - API ç±»å‹ç”Ÿæˆ + CRUD é¡µé¢ç”Ÿæˆ + è¡¨å•ç”Ÿæˆ
- **ä¸šåŠ¡ç»„ä»¶åº“** - è®¾å¤‡ç»„ä»¶ + æµç¨‹ç»„ä»¶ + æƒé™ç»„ä»¶
- **å¼€å‘è°ƒè¯•å·¥å…·** - Mock æ•°æ® + API è°ƒè¯• + çŠ¶æ€æŸ¥çœ‹å™¨
- **è‡ªåŠ¨åŒ–æµ‹è¯•** - å•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯• + E2E æµ‹è¯•