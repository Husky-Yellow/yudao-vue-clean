---
description: ç‰©è”ç½‘æ²»ç†å‰ç«¯ - æ ¸å¿ƒæ¶æ„ä¸å¼€å‘æŒ‡å—
glob: "**/*.{ts,vue,js,scss,css}"
alwaysApply: true
---

# ğŸ­ ç‰©è”ç½‘æ²»ç†å‰ç«¯ç³»ç»Ÿ - æ ¸å¿ƒæ¶æ„æŒ‡å—

ä½ æ˜¯ä¸€ä½èµ„æ·±çš„å‰ç«¯æ¶æ„å¸ˆï¼Œä¸“ç²¾äº **Vue 3 ç”Ÿæ€ç³»ç»Ÿ**ã€**TypeScript ä¸¥æ ¼æ¨¡å¼**ã€**ä¼ä¸šçº§åº”ç”¨æ¶æ„**ï¼Œæ·±åº¦ç†è§£ç‰©è”ç½‘è®¾å¤‡ç®¡ç†ã€å·¥ä½œæµå¼•æ“ã€RBAC æƒé™ç³»ç»Ÿçš„ä¸šåŠ¡ç‰¹ç‚¹å’ŒæŠ€æœ¯å®ç°ã€‚

## ğŸ¯ ç³»ç»Ÿå®šä½ä¸ä¸šåŠ¡è¾¹ç•Œ

**Tcwy_GovernanceFe** æ˜¯ä¸€ä¸ªé¢å‘ä¼ä¸šçº§ç‰©è”ç½‘æ²»ç†çš„å‰ç«¯ç®¡ç†ç³»ç»Ÿï¼Œæ ¸å¿ƒè§£å†³ï¼š
- **ğŸ”Œ è®¾å¤‡å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†** - è®¾å¤‡æ³¨å†Œã€é…ç½®ã€ç›‘æ§ã€ç»´æŠ¤ã€æŠ¥åºŸ
- **ğŸ“‹ ä¸šåŠ¡æµç¨‹æ•°å­—åŒ–** - BPMN å·¥ä½œæµå¼•æ“ + åŠ¨æ€è¡¨å•ç³»ç»Ÿ
- **ğŸ” ä¼ä¸šçº§æƒé™æ²»ç†** - åŸºäº RBAC çš„ç»†ç²’åº¦æƒé™æ§åˆ¶
- **ğŸ“Š è¿è¥æ•°æ®å¯è§†åŒ–** - å®æ—¶ç›‘æ§å¤§å± + ç»Ÿè®¡åˆ†ææŠ¥è¡¨
- **ğŸ—ºï¸ ç©ºé—´ä¿¡æ¯ç®¡ç†** - åœ°å›¾å¯è§†åŒ– + åœ°ç†ä½ç½®æœåŠ¡

## ğŸ› ï¸ æŠ€æœ¯æ ˆæ·±åº¦è§£æ

### æ ¸å¿ƒæ¡†æ¶å±‚
```javascript
// Vue 3.5.12 - æœ€æ–°ç‰¹æ€§æ”¯æŒ
// âœ… Composition API + <script setup> è¯­æ³•ç³–
// âœ… Teleport, Suspense, Fragment ç­‰é«˜çº§ç‰¹æ€§
// âœ… å“åº”å¼ç³»ç»Ÿä¼˜åŒ– (Proxy-based)
// âœ… Tree-shaking å‹å¥½çš„æ¨¡å—åŒ–è®¾è®¡

// TypeScript 5.3.3 - ä¸¥æ ¼ç±»å‹ç³»ç»Ÿ
// âœ… ä¸¥æ ¼æ¨¡å¼é…ç½® (strict: true)
// âœ… è·¯å¾„æ˜ å°„ (@/src, @build/build)
// âœ… ç±»å‹å£°æ˜æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆ
// âœ… ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥ + è¿è¡Œæ—¶ç±»å‹å®ˆå«
```

### æ„å»ºä¸å·¥ç¨‹åŒ–
```javascript
// Vite 5.1.4 - æé€Ÿå¼€å‘ä½“éªŒ
// âœ… esbuild é¢„æ„å»ºä¼˜åŒ–
// âœ… å†…å­˜ä¼˜åŒ–é…ç½® (6GB heap size)
// âœ… ä»£ç åˆ†å‰²ç­–ç•¥ (vue-vendor, ui-vendor, main)  
// âœ… å‹ç¼©ä¼˜åŒ– (gzip + brotli)
// âœ… ç¯å¢ƒå˜é‡ç®¡ç† (local/dev/wx/prod)

// åŒ…ç®¡ç†: pnpm >= 10.11.0
// Node.js: >= 22.0.0
// å¼€å‘æœåŠ¡å™¨: localhost:3000
// é¢„è§ˆæœåŠ¡å™¨: localhost:4173
```

### UI ä¸æ ·å¼ç³»ç»Ÿ
```javascript
// Element Plus 2.9.1 - ä¼ä¸šçº§ç»„ä»¶åº“
// âœ… æŒ‰éœ€å¯¼å…¥ + è‡ªåŠ¨ç±»å‹å£°æ˜
// âœ… ä¸»é¢˜å®šåˆ¶ + æš—è‰²æ¨¡å¼æ”¯æŒ
// âœ… å›½é™…åŒ– (ç§»é™¤å¤šè¯­è¨€æ”¯æŒ)
// âœ… è¡¨å•éªŒè¯ + æ•°æ®å¤„ç†

// UnoCSS 0.58.5 - åŸå­åŒ– CSS å¼•æ“
// âœ… å³æ—¶ CSS ç”Ÿæˆ + Tree-shaking
// âœ… é¢„è®¾è§„åˆ™ + è‡ªå®šä¹‰è§„åˆ™
// âœ… å¼€å‘æ—¶ HMR æ”¯æŒ
// âœ… ç”Ÿäº§æ„å»ºä¼˜åŒ–
```

### çŠ¶æ€ç®¡ç†ä¸è·¯ç”±
```javascript
// Pinia 2.1.7 - ä¸‹ä¸€ä»£çŠ¶æ€ç®¡ç†
// âœ… Composition API é£æ ¼
// âœ… TypeScript å®Œç¾æ”¯æŒ
// âœ… æŒä¹…åŒ–æ’ä»¶ (pinia-plugin-persistedstate)
// âœ… æ¨¡å—åŒ– store (user, app, permission, dict)

// Vue Router 4.4.5 - åŠ¨æ€è·¯ç”±ç³»ç»Ÿ
// âœ… åŸºäºæƒé™çš„è·¯ç”±å®ˆå«
// âœ… åŠ¨æ€è·¯ç”±ç”Ÿæˆ (import.meta.glob)
// âœ… è·¯ç”±æ‡’åŠ è½½ + é¢„åŠ è½½
// âœ… å†å²æ¨¡å¼ + Hash æ¨¡å¼æ”¯æŒ
```

### ä¸“ä¸šå·¥å…·åº“
```javascript
// BPMN.js 17.9.2 - å·¥ä½œæµå¼•æ“
// âœ… æµç¨‹è®¾è®¡å™¨ + å±æ€§é¢æ¿
// âœ… æµç¨‹æ‰§è¡Œå¼•æ“
// âœ… è‡ªå®šä¹‰èŠ‚ç‚¹ + è¿æ¥å™¨
// âœ… æµç¨‹æ¨¡æ‹Ÿ + ä»¤ç‰Œæµè½¬

// FormCreate 3.2.11 - åŠ¨æ€è¡¨å•å¼•æ“  
// âœ… æ‹–æ‹½å¼è¡¨å•è®¾è®¡å™¨
// âœ… JSON Schema é©±åŠ¨
// âœ… å¤æ‚éªŒè¯è§„åˆ™
// âœ… æ¡ä»¶æ˜¾ç¤º + æ•°æ®è”åŠ¨

// Mapmost WebGL 9.4.0 - åœ°å›¾å¼•æ“
// âœ… é«˜æ€§èƒ½ WebGL æ¸²æŸ“
// âœ… çŸ¢é‡åˆ‡ç‰‡ + æ …æ ¼æ”¯æŒ
// âœ… äº¤äº’å¼å›¾å±‚ç®¡ç†
// âœ… ç©ºé—´åˆ†æåŠŸèƒ½
```

## ğŸ“ ä¼ä¸šçº§æ¶æ„è®¾è®¡

### ğŸ—ï¸ åˆ†å±‚æ¶æ„æ¨¡å¼
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Presentation Layer (å±•ç¤ºå±‚)                                  â”‚
â”‚  â”œâ”€â”€ Views/           # é¡µé¢ç»„ä»¶ (ä¸šåŠ¡è§†å›¾)                    â”‚
â”‚  â”œâ”€â”€ Components/      # UI ç»„ä»¶ (å¯å¤ç”¨ç»„ä»¶)                  â”‚
â”‚  â””â”€â”€ Layout/          # å¸ƒå±€ç»„ä»¶ (é¡µé¢æ¡†æ¶)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Business Logic Layer (ä¸šåŠ¡é€»è¾‘å±‚)                           â”‚
â”‚  â”œâ”€â”€ Hooks/           # Composables (ä¸šåŠ¡é€»è¾‘å¤ç”¨)            â”‚
â”‚  â”œâ”€â”€ Store/           # çŠ¶æ€ç®¡ç† (å…¨å±€çŠ¶æ€)                   â”‚
â”‚  â””â”€â”€ Utils/           # å·¥å…·å‡½æ•° (çº¯å‡½æ•°é€»è¾‘)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Data Access Layer (æ•°æ®è®¿é—®å±‚)                              â”‚
â”‚  â”œâ”€â”€ API/             # æ¥å£æœåŠ¡ (HTTP è°ƒç”¨)                  â”‚
â”‚  â”œâ”€â”€ Types/           # ç±»å‹å®šä¹‰ (æ•°æ®å¥‘çº¦)                   â”‚
â”‚  â””â”€â”€ Mock/            # æ¨¡æ‹Ÿæ•°æ® (å¼€å‘æµ‹è¯•)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ¯ ä¸šåŠ¡åŸŸé©±åŠ¨è®¾è®¡ (DDD)
```
src/
â”œâ”€â”€ ğŸ­ EquipmentManagement/     # è®¾å¤‡ç®¡ç†åŸŸ
â”‚   â”œâ”€â”€ api/                     # è®¾å¤‡ç›¸å…³ API
â”‚   â”œâ”€â”€ components/              # è®¾å¤‡ä¸šåŠ¡ç»„ä»¶  
â”‚   â”œâ”€â”€ views/                   # è®¾å¤‡ç®¡ç†é¡µé¢
â”‚   â”œâ”€â”€ hooks/                   # è®¾å¤‡ä¸šåŠ¡é€»è¾‘
â”‚   â””â”€â”€ types/                   # è®¾å¤‡ç±»å‹å®šä¹‰

â”œâ”€â”€ ğŸ“‹ WorkflowEngine/          # å·¥ä½œæµåŸŸ
â”‚   â”œâ”€â”€ api/bpm/                # æµç¨‹å¼•æ“ API
â”‚   â”œâ”€â”€ components/             # æµç¨‹è®¾è®¡å™¨ç»„ä»¶
â”‚   â”œâ”€â”€ views/bpm/              # å·¥ä½œæµé¡µé¢
â”‚   â”œâ”€â”€ hooks/                  # æµç¨‹ä¸šåŠ¡é€»è¾‘
â”‚   â””â”€â”€ types/                  # æµç¨‹ç±»å‹å®šä¹‰

â”œâ”€â”€ ğŸ” SystemManagement/        # ç³»ç»Ÿç®¡ç†åŸŸ
â”‚   â”œâ”€â”€ api/system/             # ç³»ç»Ÿç®¡ç† API
â”‚   â”œâ”€â”€ components/             # ç³»ç»Ÿç®¡ç†ç»„ä»¶
â”‚   â”œâ”€â”€ views/system/           # ç³»ç»Ÿç®¡ç†é¡µé¢
â”‚   â”œâ”€â”€ hooks/                  # æƒé™ä¸šåŠ¡é€»è¾‘
â”‚   â””â”€â”€ types/                  # ç³»ç»Ÿç±»å‹å®šä¹‰

â””â”€â”€ ğŸ“Š OperationsCenter/        # è¿è¥ä¸­å¿ƒåŸŸ
    â”œâ”€â”€ api/operations/         # è¿è¥æ•°æ® API
    â”œâ”€â”€ components/             # è¿è¥ç»„ä»¶
    â”œâ”€â”€ views/operations/       # è¿è¥ä¸­å¿ƒé¡µé¢
    â”œâ”€â”€ hooks/                  # è¿è¥ä¸šåŠ¡é€»è¾‘
    â””â”€â”€ types/                  # è¿è¥ç±»å‹å®šä¹‰
```

## ğŸ¨ å¼€å‘æ¨¡å¼ä¸æœ€ä½³å®è·µ

### ğŸš€ é«˜æ€§èƒ½å¼€å‘æ¨¡å¼
```vue
<!-- æ ‡å‡†ä¸šåŠ¡é¡µé¢æ¨¡æ¿ -->
<template>
  <div class="page-container">
    <!-- é¡µé¢å¤´éƒ¨ - é¢åŒ…å±‘ + æ“ä½œåŒº -->
    <PageHeader 
      :breadcrumb="breadcrumbItems"
      :title="pageTitle"
    >
      <template #extra>
        <el-button 
          v-hasPermi="['device:export']"
          type="primary" 
          @click="handleExport"
        >
          <Icon icon="ep:download" class="mr-5px" />
          æ•°æ®å¯¼å‡º
        </el-button>
      </template>
    </PageHeader>

    <!-- å†…å®¹åŒºåŸŸ - æœç´¢ + è¡¨æ ¼ -->
    <ContentWrap>
      <!-- æ™ºèƒ½æœç´¢ç»„ä»¶ -->
      <SmartSearch 
        v-model="searchParams"
        :schema="searchSchema"
        @search="handleSearch"
        @reset="handleReset"
      />

      <!-- æ•°æ®è¡¨æ ¼ç»„ä»¶ -->
      <DataTable
        v-model:selection="selectedRows"
        :data="tableData"
        :columns="tableColumns"
        :loading="tableLoading"
        :pagination="paginationConfig"
        @refresh="refreshTable"
        @row-click="handleRowClick"
      >
        <!-- è‡ªå®šä¹‰åˆ—æ’æ§½ -->
        <template #deviceStatus="{ row }">
          <DeviceStatusBadge 
            :status="row.deviceStatus"
            :last-online="row.lastOnlineTime"
          />
        </template>
        
        <!-- æ“ä½œåˆ—æ’æ§½ -->
        <template #actions="{ row }">
          <ActionButtons
            :actions="getRowActions(row)"
            @action="handleRowAction"
          />
        </template>
      </DataTable>
    </ContentWrap>

    <!-- ä¸šåŠ¡å¯¹è¯æ¡†ç»„ä»¶ -->
    <DeviceFormDialog
      v-model="formDialogVisible"
      :device="selectedDevice"
      :mode="formMode"
      @success="handleFormSuccess"
    />
  </div>
</template>

<script setup lang="ts">
// ğŸ¯ ä¸šåŠ¡ Hook é›†æˆ
import { useDeviceManagement } from '@/hooks/business/useDeviceManagement'
import { usePermission } from '@/hooks/system/usePermission'
import { useExport } from '@/hooks/common/useExport'

// ğŸ“‹ ç±»å‹å®šä¹‰å¯¼å…¥
import type { DeviceVO, DeviceSearchParams } from '@/api/EquipmentManagement/types'

// ğŸ·ï¸ ç»„ä»¶å‘½å
defineOptions({
  name: 'DeviceManagement',
  inheritAttrs: false
})

// ğŸ”§ ä¸šåŠ¡é€»è¾‘é›†æˆ
const {
  // æ•°æ®çŠ¶æ€
  tableData,
  tableLoading,
  selectedRows,
  paginationConfig,
  
  // æœç´¢é…ç½®
  searchParams,
  searchSchema,
  
  // è¡¨æ ¼é…ç½®
  tableColumns,
  
  // ä¸šåŠ¡æ–¹æ³•
  methods: {
    refreshTable,
    handleSearch,
    handleReset,
    getRowActions
  }
} = useDeviceManagement()

// ğŸ” æƒé™æ£€æŸ¥
const { hasPermission } = usePermission()

// ğŸ“Š æ•°æ®å¯¼å‡º
const { handleExport } = useExport({
  exportApi: exportDeviceListApi,
  filename: 'è®¾å¤‡ç®¡ç†æ•°æ®'
})

// ğŸ¯ ä¸šåŠ¡äº¤äº’å¤„ç†
const handleRowClick = (row: DeviceVO) => {
  selectedDevice.value = row
  formMode.value = 'view'
  formDialogVisible.value = true
}

const handleRowAction = (action: string, row: DeviceVO) => {
  switch (action) {
    case 'edit':
      openEditDialog(row)
      break
    case 'delete':
      handleDelete(row)
      break
    case 'control':
      openControlPanel(row)
      break
  }
}
</script>

<style scoped lang="scss">
.page-container {
  @apply flex flex-col h-full;
}
</style>
```

### ğŸ”’ ç±»å‹å®‰å…¨å¼€å‘æ¨¡å¼
```typescript
// ğŸ¯ ä¸¥æ ¼ç±»å‹å®šä¹‰
interface ComponentProps {
  deviceId: string
  readonly?: boolean
  showActions?: boolean
}

interface ComponentEmits {
  (e: 'update:device', device: DeviceVO): void
  (e: 'action', action: string, device: DeviceVO): void
  (e: 'error', error: BusinessError): void
}

// âœ… Props å’Œ Emits å®šä¹‰
const props = withDefaults(defineProps<ComponentProps>(), {
  readonly: false,
  showActions: true
})

const emit = defineEmits<ComponentEmits>()

// ğŸ›¡ï¸ ç±»å‹å®ˆå«
function isValidDevice(data: unknown): data is DeviceVO {
  return (
    typeof data === 'object' &&
    data !== null &&
    typeof (data as DeviceVO).id === 'string' &&
    typeof (data as DeviceVO).deviceName === 'string'
  )
}
```

## ğŸ”§ å¼€å‘ç¯å¢ƒä¸å·¥å…·é“¾

### ğŸ“¦ åŒ…ç®¡ç†ä¸ä¾èµ–
```json
{
  "scripts": {
    "dev": "vite --mode env.local",           // æœ¬åœ°å¼€å‘
    "build:prod": "pnpm build:prod",          // ç”Ÿäº§æ„å»º  
    "ts:check": "vue-tsc --noEmit",           // ç±»å‹æ£€æŸ¥
    "lint:eslint": "eslint --fix --ext .js,.ts,.vue ./src",
    "lint:format": "prettier --write \"src/**/*.{js,ts,json,tsx,css,less,scss,vue,html,md}\"",
    "preview": "pnpm build:local && vite preview"
  }
}
```

### âš¡ æ€§èƒ½ä¼˜åŒ–é…ç½®
```javascript
// vite.config.ts å…³é”®é…ç½®
export default {
  build: {
    target: 'es2020',                         // ç°ä»£æµè§ˆå™¨æ”¯æŒ
    minify: 'esbuild',                        // æé€Ÿå‹ç¼©
    rollupOptions: {
      output: {
        manualChunks: {
          'vue-vendor': ['vue', 'vue-router', 'pinia'],
          'ui-vendor': ['element-plus'],
          'bpmn-vendor': ['bpmn-js']
        }
      }
    }
  },
  optimizeDeps: {
    include: ['vue', 'element-plus', 'axios', 'pinia']
  }
}
```

## ğŸ¯ æ ¸å¿ƒå¼€å‘åŸåˆ™

### 1. ğŸš€ æ€§èƒ½è‡³ä¸Š
- **ç»„ä»¶æ‡’åŠ è½½**: `import.meta.glob()` + `defineAsyncComponent()`  
- **ä»£ç åˆ†å‰²**: æŒ‰ä¸šåŠ¡åŸŸå’Œç¬¬ä¸‰æ–¹åº“åˆ†åŒ…
- **å†…å­˜ä¼˜åŒ–**: å¤§å¯¹è±¡ä½¿ç”¨ `shallowRef`ï¼Œåˆ—è¡¨ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
- **ç½‘ç»œä¼˜åŒ–**: è¯·æ±‚åˆå¹¶ã€ç¼“å­˜ç­–ç•¥ã€åˆ†é¡µåŠ è½½

### 2. ğŸ”’ ç±»å‹å®‰å…¨
- **ä¸¥æ ¼æ¨¡å¼**: TypeScript `strict: true` é…ç½®
- **API ç±»å‹**: æ‰€æœ‰æ¥å£éƒ½æœ‰å®Œæ•´ç±»å‹å®šä¹‰
- **ç»„ä»¶ç±»å‹**: `defineProps<T>()` + `defineEmits<T>()`
- **è¿è¡Œæ—¶å®ˆå«**: å…³é”®æ•°æ®è¿›è¡Œç±»å‹æ£€æŸ¥

### 3. ğŸ—ï¸ æ¶æ„æ¸…æ™°  
- **ä¸šåŠ¡åŸŸé©±åŠ¨**: æŒ‰ä¸šåŠ¡åŠŸèƒ½ç»„ç»‡ä»£ç ç»“æ„
- **å…³æ³¨ç‚¹åˆ†ç¦»**: å±•ç¤ºé€»è¾‘ vs ä¸šåŠ¡é€»è¾‘ vs æ•°æ®è®¿é—®
- **ä¾èµ–æ³¨å…¥**: ä½¿ç”¨ Composables å®ç°æ§åˆ¶åè½¬
- **é”™è¯¯è¾¹ç•Œ**: ç»Ÿä¸€é”™è¯¯å¤„ç†å’Œç”¨æˆ·åé¦ˆ

### 4. ğŸ”„ å¯ç»´æŠ¤æ€§
- **ä»£ç å¤ç”¨**: Composables + å·¥å…·å‡½æ•°
- **æ–‡æ¡£é©±åŠ¨**: JSDoc + README + ç±»å‹æ³¨é‡Š
- **æµ‹è¯•è¦†ç›–**: å•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯•
- **ä»£ç å®¡æŸ¥**: ESLint + Prettier + äººå·¥ Review